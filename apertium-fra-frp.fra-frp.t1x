<?xml version="1.0" encoding="UTF-8"?>
<transfer default="chunk">
  <section-def-cats>
    <def-cat n="det">
      <cat-item tags="det.*"/>
      <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="detdef">
      <cat-item tags="det.def.*"/>
    </def-cat>
    <def-cat n="ce_det">
      <cat-item lemma="ce" tags="det.dem.*"/>
    </def-cat>
    <def-cat n="det_num">
      <cat-item tags="det.*"/>
      <cat-item tags="num"/>
      <cat-item tags="num.*"/>
    </def-cat>

    <def-cat n="predet">
      <cat-item tags="predet.*"/>
    </def-cat>

    <def-cat n="nom">
      <cat-item tags="n.*"/>
    </def-cat>

    <def-cat n="np">
      <cat-item tags="np.*"/>
    </def-cat>
    <def-cat n="nptop">
      <cat-item tags="np.top.*"/>
      <cat-item tags="np.loc"/>
    </def-cat>
    <def-cat n="npal">
      <cat-item tags="np.al"/>
      <cat-item tags="np.al.*"/>
    </def-cat>

    <def-cat n="adj">
      <cat-item tags="adj.*"/>
    </def-cat>
    <def-cat n="adjec">
      <cat-item tags="adj.*"/>
      <cat-item tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="adjec_pref">
      <cat-item tags="adj.*"/>
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="pref"/>
    </def-cat>

    <def-cat n="pref">
      <cat-item tags="pref"/>
    </def-cat>

    <def-cat n="adv">
      <cat-item tags="adv"/>
    </def-cat>
    <def-cat n="advitg">
      <cat-item tags="adv.itg"/>
    </def-cat>
    <def-cat n="preadv">
      <cat-item tags="preadv"/>
    </def-cat>
    <def-cat n="adv_preadv">
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
    </def-cat>
    <def-cat n="adv_preadv_pref">
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
      <cat-item tags="pref"/>
    </def-cat>
    <def-cat n="postadv">
      <cat-item tags="postadv"/>
    </def-cat>
    <def-cat n="ci_postadv">
      <cat-item lemma="ci" tags="postadv"/>
    </def-cat>
    <def-cat n="la_postadv">
      <cat-item lemma="là" tags="postadv"/>
    </def-cat>
    <def-cat n="ne">
      <cat-item lemma="ne" tags="adv"/>
    </def-cat>
    <def-cat n="pas">
      <cat-item lemma="pas" tags="adv"/>
      <cat-item lemma="jamais" tags="adv"/>
      <cat-item lemma="plus jamais" tags="adv"/>
      <cat-item lemma="plus guère" tags="adv"/>
    </def-cat>
    <def-cat n="plus_guere">
      <cat-item lemma="plus" tags="adv"/>
      <cat-item lemma="guère" tags="adv"/>
    </def-cat>
    <def-cat n="rien">
      <cat-item lemma="rien" tags="prn.*"/>
    </def-cat>
    <def-cat n="personne">
      <cat-item lemma="personne" tags="prn.*"/>
      <cat-item lemma="aucun" tags="prn.*"/>
    </def-cat>
    <def-cat n="rien_personne">
      <cat-item lemma="rien" tags="prn.*"/>
      <cat-item lemma="personne" tags="prn.*"/>
    </def-cat>
    <def-cat n="adv_rien_personne">
      <cat-item tags="adv"/>
      <cat-item lemma="rien" tags="prn.*"/>
      <cat-item lemma="personne" tags="prn.*"/>
      <cat-item lemma="aucun" tags="prn.*"/>
    </def-cat>
    <def-cat n="longtemps">
      <cat-item lemma="longtemps" tags="adv"/>
    </def-cat>
    <def-cat n="en_fait">
      <cat-item lemma="en fait" tags="adv"/>
    </def-cat>

    <def-cat n="prn">
      <cat-item tags="prn.*"/>
    </def-cat>
    <def-cat n="prnpro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>
    <def-cat n="prnenc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>
    <def-cat n="prnsubj">
      <cat-item lemma="je" tags="prn.tn.p1.mf.sg"/>
      <cat-item lemma="tu" tags="prn.tn.p2.mf.sg"/>
      <cat-item lemma="il" tags="prn.tn.p3.m.sg"/>
      <cat-item lemma="il" tags="prn.tn.p3.f.sg"/>
      <cat-item lemma="nous" tags="prn.tn.p1.mf.pl"/>
      <cat-item lemma="vous" tags="prn.tn.p2.mf.pl"/>
      <cat-item lemma="il" tags="prn.tn.p3.m.pl"/>
      <cat-item lemma="il" tags="prn.tn.p3.f.pl"/>
    </def-cat>
    <def-cat n="il">
      <cat-item lemma="il" tags="prn.tn.p3.m.sg"/>
    </def-cat>
    <def-cat n="il_elle">
      <cat-item lemma="il" tags="prn.tn.p3.m.sg"/>
      <cat-item lemma="il" tags="prn.tn.p3.f.sg"/>
    </def-cat>
    <def-cat n="on">
      <cat-item lemma="on" tags="prn.pro.ref.p3.mf.sp"/>
    </def-cat>
    <def-cat n="se">
      <cat-item lemma="se" tags="prn.pro.ref.p3.mf.sp"/>
    </def-cat>
    <def-cat n="prnref">
      <cat-item lemma="me" tags="prn.pro.p1.mf.sg"/>
      <cat-item lemma="te" tags="prn.pro.p2.mf.sg"/>
      <cat-item lemma="se" tags="prn.pro.ref.p3.mf.sp"/>
      <cat-item lemma="nous" tags="prn.pro.p1.mf.pl"/>
      <cat-item lemma="vous" tags="prn.pro.p2.mf.pl"/>
    </def-cat>
    <def-cat n="prndat">
      <cat-item lemma="me" tags="prn.pro.p1.mf.sg"/>
      <cat-item lemma="te" tags="prn.pro.p2.mf.sg"/>
      <cat-item lemma="lui" tags="prn.pro.p3.mf.sg"/>
      <cat-item lemma="nous" tags="prn.pro.p1.mf.pl"/>
      <cat-item lemma="vous" tags="prn.pro.p2.mf.pl"/>
      <cat-item lemma="leur" tags="prn.pro.p3.mf.pl"/>
    </def-cat>
    <def-cat n="enprn">
      <cat-item lemma="en" tags="prn.*"/>
    </def-cat>
    <def-cat n="y">
      <cat-item lemma="y" tags="prn.pro.adv"/>
    </def-cat>
    <def-cat n="estceque">
      <cat-item lemma="est-ce que" tags="prn.*"/>
    </def-cat>
    <def-cat n="ce">
      <cat-item lemma="ce" tags="prn.*"/>
    </def-cat>
    <def-cat n="ça">
      <cat-item lemma="ça" tags="prn.*"/>
    </def-cat>

    <def-cat n="num">
      <cat-item tags="num"/>
      <cat-item tags="num.*"/>
    </def-cat>

    <def-cat n="deux">
      <cat-item lemma="deux" tags="num.*"/>
    </def-cat>

    <def-cat n="num_premier"> <!-- per datas -->
      <cat-item tags="num"/>
      <cat-item tags="num.*"/>
      <cat-item lemma="1er" tags="adj.*"/>
      <cat-item lemma="premier" tags="adj.*"/>
    </def-cat>

    <def-cat n="pr">
      <cat-item tags="pr"/>
    </def-cat>
    <def-cat n="deprep">
      <cat-item lemma="de" tags="pr"/>
    </def-cat>
    <def-cat n="enprep">
      <cat-item lemma="en" tags="pr"/>
    </def-cat>

    <def-cat n="cnjcoo">
      <cat-item tags="cnjcoo"/>
    </def-cat>

    <def-cat n="cnjsub">
      <cat-item tags="cnjsub"/>
    </def-cat>
    <def-cat n="que_cnjsub">
      <cat-item lemma="que" tags="cnjsub"/>
    </def-cat>

    <def-cat n="cnjadv">
      <cat-item tags="cnjadv"/>
    </def-cat>

    <def-cat n="rel">
      <cat-item tags="rel.*"/>
    </def-cat>

    <def-cat n="verb">
      <cat-item tags="vblex.*"/>
      <cat-item tags="vbser.*"/>
      <cat-item tags="vbhaver.*"/>
      <cat-item tags="vbmod.*"/>
    </def-cat>

    <def-cat n="vaux">
      <cat-item tags="vbser.*"/>
      <cat-item tags="vbhaver.*"/>
    </def-cat>

    <def-cat n="verbconj">
      <cat-item tags="vblex.*.p1.*"/>
      <cat-item tags="vblex.*.p2.*"/>
      <cat-item tags="vblex.*.p3.*"/>
      <cat-item tags="vbhaver.*.p1.*"/>
      <cat-item tags="vbhaver.*.p2.*"/>
      <cat-item tags="vbhaver.*.p3.*"/>
      <cat-item tags="vbser.*.p1.*"/>
      <cat-item tags="vbser.*.p2.*"/>
      <cat-item tags="vbser.*.p3.*"/>
      <cat-item tags="vbmod.*.p1.*"/>
      <cat-item tags="vbmod.*.p2.*"/>
      <cat-item tags="vbmod.*.p3.*"/>
    </def-cat>

    <def-cat n="verbp3">
      <cat-item tags="vblex.*.p3.*"/>
      <cat-item tags="vbhaver.*.p3.*"/>
      <cat-item tags="vbser.*.p3.*"/>
      <cat-item tags="vbmod.*.p3.*"/>
    </def-cat>
    <def-cat n="devoirp3sg">
      <cat-item lemma="devoir" tags="vblex.*.p3.sg"/>
      <cat-item lemma="devoir" tags="vbmod.*.p3.sg"/>
    </def-cat>

    <def-cat n="vbser">
      <cat-item tags="vbser.*"/>
    </def-cat>

    <def-cat n="vbser_pp">
      <cat-item tags="vbser.pp.*"/>
    </def-cat>

    <def-cat n="vbhaver">
      <cat-item tags="vbhaver.*"/>
    </def-cat>

    <def-cat n="a">
      <cat-item tags="vbhaver.pri.p3.sg"/>
    </def-cat>

    <def-cat n="appartenir">
      <cat-item lemma="appartenir" tags="vblex.*"/>
    </def-cat>

    <def-cat n="appartenir_pp">
      <cat-item lemma="appartenir" tags="vblex.pp.*"/>
    </def-cat>

    <def-cat n="vbhaverconj">
      <cat-item tags="vbhaver.*.p1.*"/>
      <cat-item tags="vbhaver.*.p2.*"/>
      <cat-item tags="vbhaver.*.p3.*"/>
    </def-cat>

    <def-cat n="vbhaverinfger">
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbhaver.ger"/>
    </def-cat>

    <def-cat n="vbmod">
      <cat-item tags="vbmod.*"/>
    </def-cat>

    <def-cat n="vbaux">
      <cat-item tags="vbser.*"/>
      <cat-item tags="vbhaver.*"/>
    </def-cat>

    <def-cat n="vbnoser">
      <cat-item tags="vblex.*"/>
      <cat-item tags="vbhaver.*"/>
      <cat-item tags="vbmod.*"/>
    </def-cat>

    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.tv.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbmod.inf"/>
    </def-cat>

    <def-cat n="ger">
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vblex.tv.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>

    <def-cat n="imp">
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vblex.tv.imp.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbmod.imp.*"/>
    </def-cat>

    <def-cat n="pp">
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vblex.tv.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
    </def-cat>

    <def-cat n="pp_no_ser">
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vblex.tv.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
    </def-cat>

    <def-cat n="cm">
      <cat-item tags="cm"/>
    </def-cat>
    <def-cat n="lpar">
      <cat-item tags="lpar"/>
    </def-cat>
    <def-cat n="rpar">
      <cat-item tags="rpar"/>
    </def-cat>
    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat>

    <def-cat n="train">
      <cat-item lemma="train" tags="n.*"/>
    </def-cat>

    <def-cat n="aller">
      <cat-item lemma="aller" tags="vblex.*"/>
    </def-cat>

    <def-cat n="n_temps">
      <cat-item lemma="seconde" tags="n.*"/>
      <cat-item lemma="minute" tags="n.*"/>
      <cat-item lemma="heure" tags="n.*"/>
      <cat-item lemma="jour" tags="n.*"/>
      <cat-item lemma="semaine" tags="n.*"/>
      <cat-item lemma="mois" tags="n.*"/>
      <cat-item lemma="trimestre" tags="n.*"/>
      <cat-item lemma="an" tags="n.*"/>
      <cat-item lemma="année" tags="n.*"/>
      <cat-item lemma="lustre" tags="n.*"/>
      <cat-item lemma="siècle" tags="n.*"/>
      <cat-item lemma="millénaire" tags="n.*"/>
    </def-cat>

    <def-cat n="nom_mois">
      <cat-item lemma="janvier" tags="n.*"/>
      <cat-item lemma="février" tags="n.*"/>
      <cat-item lemma="mars" tags="n.*"/>
      <cat-item lemma="avril" tags="n.*"/>
      <cat-item lemma="mai" tags="n.*"/>
      <cat-item lemma="juin" tags="n.*"/>
      <cat-item lemma="juillet" tags="n.*"/>
      <cat-item lemma="août" tags="n.*"/>
      <cat-item lemma="septembre" tags="n.*"/>
      <cat-item lemma="octobre" tags="n.*"/>
      <cat-item lemma="novembre" tags="n.*"/>
      <cat-item lemma="décembre" tags="n.*"/>
      <cat-item lemma="vendémiaire" tags="n.*"/>
      <cat-item lemma="brumaire" tags="n.*"/>
      <cat-item lemma="frimaire" tags="n.*"/>
      <cat-item lemma="nivôse" tags="n.*"/>
      <cat-item lemma="pluviôse" tags="n.*"/>
      <cat-item lemma="ventôse" tags="n.*"/>
      <cat-item lemma="germinal" tags="n.*"/>
      <cat-item lemma="floréal" tags="n.*"/>
      <cat-item lemma="prairial" tags="n.*"/>
      <cat-item lemma="messidor" tags="n.*"/>
      <cat-item lemma="thermidor" tags="n.*"/>
      <cat-item lemma="fructidor" tags="n.*"/>
    </def-cat>

  </section-def-cats>

  <section-def-attrs>
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
      <attr-item tags="np.ant"/>
    </def-attr>

    <def-attr n="a_det">
      <attr-item tags="det.def"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.dem"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="predet"/>
    </def-attr>

    <def-attr n="a_det2">
      <attr-item tags="def"/>
      <attr-item tags="ind"/>
      <attr-item tags="dem"/>
      <attr-item tags="pos"/>
      <attr-item tags="predet"/>
    </def-attr>

    <def-attr n="a_adjec">
      <attr-item tags="adj.ind"/>
      <attr-item tags="adj.ord"/>
      <attr-item tags="adj.sup"/>
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj"/>
      <attr-item tags="vblex.pp"/>
      <attr-item tags="vblex.tv.pp"/>
      <attr-item tags="vbhaver.pp"/>
      <attr-item tags="vbser.pp"/>
      <attr-item tags="vbmod.pp"/>
    </def-attr>

    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
    </def-attr>

    <def-attr n="a_verb_pron">
      <attr-item tags="vblex.pron"/>
      <attr-item tags="vblex.no_pron"/>
    </def-attr>

    <def-attr n="a_num">
      <attr-item tags="num"/>
    </def-attr>

    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>

    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="mf"/>
      <attr-item tags="f"/>
      <attr-item tags="GD"/>
    </def-attr>

    <def-attr n="pers">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>

    <def-attr n="temps">
      <attr-item tags="inf"/>
      <attr-item tags="ger"/>
      <attr-item tags="pp"/>
      <attr-item tags="pri"/>
      <attr-item tags="ifi"/>
      <attr-item tags="pii"/>
      <attr-item tags="fti"/>
      <attr-item tags="cni"/>
      <attr-item tags="prs"/>
      <attr-item tags="pis"/>
      <attr-item tags="fts"/>
      <attr-item tags="imp"/>
    </def-attr>

    <def-attr n="pron">
      <attr-item tags="prn.tn"/>
      <attr-item tags="prn.pro"/>
      <attr-item tags="prn.pro.ref"/>
      <attr-item tags="prn.enc"/>
    </def-attr>

    <def-attr n="tv">
      <attr-item tags="tv"/>
    </def-attr>
  </section-def-attrs>

  <section-def-vars>
    <def-var n="lemma"/>
    <def-var n="number"/>
    <def-var n="numvist"/>
    <def-var n="varporque"/>
    <def-var n="tipusdet"/>
    <def-var n="tipusprn"/>
    <def-var n="uno"/>
    <def-var n="genero"/>
    <def-var n="numero"/>
    <def-var n="genero_sl"/>
    <def-var n="numero_sl"/>
    <def-var n="concDet"/>
    <def-var n="concAdj"/>
    <def-var n="concPrimero"/>
    <def-var n="concSegundo"/>
    <def-var n="concTercero"/>
    <def-var n="interrogativa"/>
    <def-var n="exclamativa"/>
    <def-var n="pronom"/>
    <def-var n="auxg"/>
    <def-var n="auxn"/>
    <def-var n="temp"/>
  </section-def-vars>

  <section-def-lists>
    <def-list n="mois">
      <list-item v="janvier"/>
      <list-item v="février"/>
      <list-item v="mars"/>
      <list-item v="avril"/>
      <list-item v="mai"/>
      <list-item v="juin"/>
      <list-item v="juillet"/>
      <list-item v="août"/>
      <list-item v="septembre"/>
      <list-item v="octobre"/>
      <list-item v="novembre"/>
      <list-item v="décembre"/>
    </def-list>

    <def-list n="l_plus_guere">
      <list-item v="plus"/>
      <list-item v="guère"/>
    </def-list>

    <def-list n="adj_frp_post"> <!-- adjectifs frp qui doivent aller après le nom -->
      <list-item v="prochen"/>
      <list-item v="que vint"/>
    </def-list>

    <def-list n="vaux_etre"> <!-- verbes qu'il faut conjuguer avec étre -->
      <list-item v="alar"/>
      <list-item v="aparêtre"/>
      <list-item v="parêtre"/>
      <list-item v="arrevar"/>
      <list-item v="venir"/>
      <list-item v="vegnir"/>
      <list-item v="partir"/>
      <list-item v="nêtre"/>
      <list-item v="renêtre"/>
      <list-item v="morir"/>
      <list-item v="dèscendre"/>
      <list-item v="montar"/>
      <list-item v="entrar"/>
      <list-item v="rentrar"/>
      <list-item v="sortir"/>
      <list-item v="chêre"/>
      <list-item v="retornar"/>
      <list-item v="rentornar"/>
      <list-item v="passar"/>
      <list-item v="réstar"/>
      <list-item v="devenir"/>
      <list-item v="revenir"/>
    </def-list>
  </section-def-lists>

  <section-def-macros>
    <def-macro n="test" npar="1">
          <let>
            <var n="number"/>
            <lit v=""/>
          </let>
    </def-macro>

    <def-macro n="f_concord_pedac2" npar="2">
<!--Pedaç ad-hoc per solucionar problemes amb l'assignació del nombre a "nombreux prix" et sim. -->
      <choose>
        <when>
          <test>
            <and>
              <equal><clip pos="2" side="sl" part="lem"/><lit v="nombreux"/></equal>
              <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="m"/></equal>
              <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
              <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </and>
          </test>
          <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></let>
          <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_concord0" npar="1">
      <choose>
<!--To determine value of variables of gender and
                 number and propagate to other rules.  Variables are
                 not used again in this rule -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_concord1" npar="1">
      <call-macro n="f_concord0"><with-param pos="1"/></call-macro>
      <choose>
        <when>
          <test>
<!-- If word has GD or ND, we try to assign the
              gender or number of the previous rule. If there is no
              value for the gender or number variable from previous
              rules, gender will be masculine and number singular.-->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="genero"/>
                  <lit-tag v="f"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="f"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="pl"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_concord2" npar="2">

      <call-macro n="f_concord_pedac2">
        <with-param pos="1"/>
        <with-param pos="2"/>
      </call-macro>

      <choose>
        <when>
          <test>
<!-- do the main and second parameter gender agree?-->
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
<!-- do the main and second parameter number agree?-->
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
<!-- there is gender and number agreement-->
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
<!-- there isn't gender and number agreement-->
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
<!-- Propagate the main parameter gender if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- Propagate the main parameter number if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- Which is the rule general gender? -->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
<!-- Which is the rule general number? -->
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>

        <when>
          <test>
            <and>
            <equal>
              <clip pos="2" side="tl" part="a_num"/>
              <lit-tag v="num"/>
            </equal>
            <not>
            <equal>
              <clip pos="2" side="tl" part="lem"/>
              <lit v="1"/>
            </equal>
            </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>

        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Determine gender and number value if they are undetermined -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_concord3" npar="3">
      <choose>
<!-- Look whether in source language there is concordance between first and second element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Look whether in source language there is concordance between second and third element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Propagate the main parameter gender if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
<!-- Propagate the main parameter number if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
<!-- Determine the rule general gender. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="3" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Determine the rule general number. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="3" side="sl" part="nbr"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Assign values to GD and ND -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_concord4" npar="4">
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concTercero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concTercero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_chunk_tags" npar="1">
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="m"/></equal>
          </test>
          <let><var n="genero_sl"/><lit-tag v="sl_m"/></let>
        </when>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="f"/></equal>
          </test>
          <let><var n="genero_sl"/><lit-tag v="sl_f"/></let>
        </when>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="mf"/></equal>
          </test>
          <let><var n="genero_sl"/><lit-tag v="sl_mf"/></let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sg"/></equal>
          </test>
          <let><var n="numero_sl"/><lit-tag v="sl_sg"/></let>
        </when>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
          </test>
          <let><var n="numero_sl"/><lit-tag v="sl_pl"/></let>
        </when>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
          </test>
          <let><var n="numero_sl"/><lit-tag v="sl_sp"/></let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="tipus_det" npar="1"> <!-- tots els det passen per aqui -->
      <choose>
        <when>
          <test>
            <equal caseless="yes">
             <clip pos="1" side="sl" part="lem"/><lit v="aucun"/>
            </equal>
          </test>
          <let><var n="tipusdet"/><lit-tag v="aucun"/></let>
        </when>
        <otherwise>
          <let><var n="tipusdet"/><clip pos="1" side="sl" part="a_det2"/></let>
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="tipus_prn" npar="1"> <!-- tots els prn passen per aqui -->
      <choose>
        <when>
          <test>
            <equal caseless="yes">
             <clip pos="1" side="sl" part="lem"/><lit v="se"/>
            </equal>
          </test>
          <let><var n="tipusprn"/><lit-tag v="ref"/></let>
        </when>
        <otherwise>
          <let><var n="tipusprn"/><lit-tag v="normal"/></let>
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="out_verb1" npar="1">
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="temps" />
              <lit-tag v="ifi" />
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <case-of pos="1" side="sl" part="lemh" />
                  <lit v="Aa" />
                </equal>
              </test>
              <modify-case>
                <clip pos="1" side="tl" part="lemh" />
                <lit v="aa" />
              </modify-case>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <in caseless="yes">
                  <clip pos="1" side="tl" part="lemh"/>
                  <list n="vaux_etre"/>
                </in>
              </test>
              <out>
                <chunk name="verb">
                  <tags>
                    <tag><lit-tag v="SVpp"/></tag>
                    <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                    <tag><var n="genero"/></tag>
                    <tag><clip pos="1" side="tl" part="nbr"/></tag>
                    <tag><var n="genero_sl"/></tag>
                    <tag><var n="numero_sl"/></tag>
                  </tags>
                  <lu>
                    <get-case-from pos="1">
                      <lit v="étre" />
                    </get-case-from>
                    <lit-tag v="vbser" />
                    <lit-tag v="pri" />
                    <clip pos="1" side="sl" part="pers" />
                    <clip pos="1" side="sl" part="nbr" />
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lemh" />
                    <clip pos="1" side="tl" part="a_verb" />
                    <lit-tag v="pp" />
                    <lit-tag v="3" />
                    <clip pos="1" side="sl" part="nbr" />
                    <clip pos="1" side="tl" part="lemq" />
                  </lu>
                </chunk>
              </out>
            </when>
            <otherwise>
              <out>
                <chunk name="verb">
                  <tags>
                    <tag><lit-tag v="SVpp"/></tag>
                    <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                    <tag><lit-tag v="m"/></tag>
                    <tag><clip pos="1" side="tl" part="nbr"/></tag>
                    <tag><var n="genero_sl"/></tag>
                    <tag><var n="numero_sl"/></tag>
                  </tags>
                  <lu>
                    <get-case-from pos="1">
                      <lit v="avêr" />
                    </get-case-from>
                    <lit-tag v="vbhaver" />
                    <lit-tag v="pri" />
                    <clip pos="1" side="sl" part="pers" />
                    <clip pos="1" side="sl" part="nbr" />
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lemh" />
                    <clip pos="1" side="tl" part="a_verb" />
                    <lit-tag v="pp" />
                    <lit-tag v="m" />
                    <lit-tag v="sg" />
                    <clip pos="1" side="tl" part="lemq" />
                  </lu>
                </chunk>
              </out>
            </otherwise>
          </choose>
        </when>
        <otherwise>
          <choose>
            <when>
              <test>
                <equal>
                  <clip pos="1" side="sl" part="temps" />
                  <lit-tag v="pis" />
                </equal>
              </test>
              <let><clip pos="1" side="tl" part="temps" /><lit-tag v="prs" /></let>
            </when>
          </choose>
          <out>
            <chunk name="verb">
              <tags>
                <tag><lit-tag v="SV"/></tag>
                <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="pers"/>
                <clip pos="1" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="lemq"/>
               </lu>
            </chunk>
          </out>
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="out_verb_ser1" npar="1">	<!-- comme out_verb1, mais toujours avec 'étre' si ifi -->
      <choose>
        <when>
          <test>
            <equal><var n="genero"/><lit v="" /></equal>
          </test>
          <let><var n="genero"/><lit-tag v="m" /></let>	<!-- pour qu'il y ait quelque chose -->
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="temps" />
              <lit-tag v="ifi" />
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <case-of pos="1" side="sl" part="lemh" />
                  <lit v="Aa" />
                </equal>
              </test>
              <modify-case>
                <clip pos="1" side="tl" part="lemh" />
                <lit v="aa" />
              </modify-case>
            </when>
          </choose>
          <out>
            <chunk name="verb">
              <tags>
                <tag><lit-tag v="SVpp"/></tag>
                <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                <tag><var n="genero"/></tag>
                <tag><clip pos="1" side="tl" part="nbr"/></tag>
                <tag><var n="genero_sl"/></tag>
                <tag><var n="numero_sl"/></tag>
              </tags>
              <lu>
                <get-case-from pos="1">
                  <lit v="étre" />
                </get-case-from>
                <lit-tag v="vbser" />
                <lit-tag v="pri" />
                <clip pos="1" side="sl" part="pers" />
                <clip pos="1" side="sl" part="nbr" />
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lemh" />
                <clip pos="1" side="tl" part="a_verb" />
                <lit-tag v="pp" />
                <lit-tag v="3" />
                <clip pos="1" side="sl" part="nbr" />
                <clip pos="1" side="tl" part="lemq" />
              </lu>
            </chunk>
          </out>
        </when>
        <otherwise>
          <choose>
            <when>
              <test>
                <equal>
                  <clip pos="1" side="sl" part="temps" />
                  <lit-tag v="pis" />
                </equal>
              </test>
              <let><clip pos="1" side="tl" part="temps" /><lit-tag v="prs" /></let>
            </when>
          </choose>
          <out>
            <chunk name="verb">
              <tags>
                <tag><lit-tag v="SV"/></tag>
                <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="pers"/>
                <clip pos="1" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="lemq"/>
               </lu>
            </chunk>
          </out>
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="f_set_pron" npar="2"> <!-- posa a la variable 'pronom' el pronom reflexiu que calgui si el verb és reflexiu. El segon paramàtre és la repetició del primer, si és una forma conjugada (personal) del verb, altrament és l'auxiliar-->
      <let><var n="pronom"/><lit v=""/></let>
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex.pron"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex"/></let>
          <append n="pronom">
            <lit v="^"/>
            <lit v="prn"/>
            <lit-tag v="SPron.pref"/>
            <lit v="{"/>
          </append>
          <choose>
            <when>
              <test>
                <or>
                  <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p3"/></equal>
                  <equal><clip pos="2" side="tl" part="pers"/><lit v=""/></equal>
                </or>
              </test>
              <append n="pronom">
                <lit v="^"/>
                <get-case-from pos="2">
                  <lit v="sè"/>
                </get-case-from>
              </append>
              <append n="pronom">
                <lit-tag v="prn.pro.ref.p3.mf.sp"/>
                <lit v="$}$"/>
                <b/>
              </append>    
            </when>
            <when>
              <test>
                <and>
                  <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                  <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                </and>
              </test>
              <append n="pronom">
                <lit v="^"/>
                <get-case-from pos="2">
                  <lit v="mè"/>
                </get-case-from>
              </append>
              <append n="pronom">
                <lit-tag v="prn.pro.p1.mf.sg"/>
                <lit v="$}$"/>
                <b/>
              </append>    
            </when>
            <when>
              <test>
                <and>
                  <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                  <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                </and>
              </test>
              <append n="pronom">
                <lit v="^"/>
                <get-case-from pos="2">
                  <lit v="tè"/>
                </get-case-from>
              </append>
              <append n="pronom">
                <lit-tag v="prn.pro.p2.mf.sg"/>
                <lit v="$}$"/>
                <b/>
              </append>    
            </when>
            <when>
              <test>
                <and>
                  <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                  <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                </and>
              </test>
              <append n="pronom">
                <lit v="^"/>
                <get-case-from pos="2">
                  <lit v="nos"/>
                </get-case-from>
              </append>
              <append n="pronom">
                <lit-tag v="prn.pro.p1.mf.pl"/>
                <lit v="$}$"/>
                <b/>
              </append>    
            </when>
            <when>
              <test>
                <and>
                  <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                  <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                </and>
              </test>
              <append n="pronom">
                <lit v="^"/>
                <get-case-from pos="2">
                  <lit v="vos"/>
                </get-case-from>
              </append>
              <append n="pronom">
                <lit-tag v="prn.pro.p2.mf.pl"/>
                <lit v="$}$"/>
                <b/>
              </append>    
            </when>
          </choose>
          <!-- ara arreglem la majúscula del verb, si cal -->
          <choose>
            <when>
              <test>
                <equal>
                   <case-of pos="2" side="sl" part="lem"/>
                   <lit v="Aa"/>
                 </equal>
              </test>
              <modify-case>
                <clip pos="2" side="tl" part="lemh"/>
                <lit v="aa"/>
              </modify-case>
            </when>
          </choose>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_bcond" npar="2"><!--Per mirar si el blanc conté o no format. Cal posar aquesta funció en les regles en què desaparegui alguna paraula, per tal de decidir si el blanc de la paraula eliminada s'ha d'eliminar o conservar. Si conté format cal conservar-la, si no en conté cal eliminar-la perquè no apareguin dos espais seguits. -->
      <choose>
        <when>
          <test>
            <not>
              <equal>
                <b pos="1"/>
                <lit v=" "/>
              </equal>
            </not>
          </test>
          <out>
            <b pos="1"/>
          </out>
        </when>
      </choose>
    </def-macro>

  </section-def-macros>

  <section-rules>

    <!-- REGLES CAPÇALERA CHUNK + LEMH/LEMQ -->

    <rule comment="REGLA: DET">
       <pattern>
         <pattern-item n="det"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
         <out>
           <chunk name="det">
             <tags>
               <tag><lit-tag v="Det"/></tag>
               <tag><var n="tipusdet"/></tag>
               <tag><clip pos="1" side="tl" part="gen"/></tag>
               <tag><clip pos="1" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
            </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NOM">
      <pattern>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="n">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: NP">
      <pattern>
        <pattern-item n="np"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="np">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: ADJ">
      <pattern>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when> <!-- <e><p><l>II<s n="num"/><s n="mf"/><s n="sp"/></l><r>IIe<s n="adj"/><s n="mf"/><s n="sg"/></r></p></e> -->
            <test>
              <equal>
                <clip pos="1" side="tl" part="a_num"/><lit-tag v="num"/>
              </equal>
            </test>
            <out>
             <chunk name="num">
               <tags>
                 <tag><lit-tag v="Num"/></tag>
               </tags>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
             </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="a">
                <tags>
                  <tag><lit-tag v="SA"/></tag>
                  <tag><clip pos="1" side="tl" part="gen"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_adjec"/>
                  <lit-tag v="2"/>
                  <lit-tag v="3"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: pp">
      <pattern>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma">
            <tags>
              <tag><lit-tag v="SA_pp"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="2"/>
              <lit-tag v="3"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: ADV">
      <pattern>
        <pattern-item n="adv_preadv_pref"/>
      </pattern>
      <action>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma">
            <tags>
              <tag><lit-tag v="SAdv"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PREADV ADV (empaquetament en un sol chunk per t2x)">
      <pattern>
        <pattern-item n="preadv"/>
        <pattern-item n="adv"/>
      </pattern>
      <action>
        <out>
          <chunk name="preadv_adv">
            <tags>
              <tag><lit-tag v="SAdv"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PRN">
       <pattern>
         <pattern-item n="prn"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="tipus_prn">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="prn">
             <tags>
               <tag><lit-tag v="SPron"/></tag>
               <tag><var n="tipusprn"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NUMERAL">
      <pattern>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
         <chunk name="num">
           <tags>
             <tag><lit-tag v="Num"/></tag>
           </tags>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
         </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PREP">
      <pattern>
        <pattern-item n="pr"/>
      </pattern>
      <action>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma">
           <tags>
             <tag><lit-tag v="PREP"/></tag>
           </tags>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
         </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: CNJCOO">
      <pattern>
        <pattern-item n="cnjcoo"/>
      </pattern>
      <action>
        <out>
          <chunk name="cnjcoo">
            <tags>
              <tag><lit-tag v="cnjcoo"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: CNJSUB">
      <pattern>
        <pattern-item n="cnjsub"/>
      </pattern>
      <action>
        <out>
          <chunk name="cnjsub">
            <tags>
              <tag><lit-tag v="cnjsub"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: CNJADV">
      <pattern>
        <pattern-item n="cnjadv"/>
      </pattern>
      <action>
        <out>
          <chunk name="cnjadv">
            <tags>
              <tag><lit-tag v="cnjadv"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: RELATIF">
      <pattern>
        <pattern-item n="rel"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma">
           <tags>
             <tag><lit-tag v="Rel"/></tag>
           </tags>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
         </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: VBSER: elles furent > els ant étâ">
       <pattern>
         <pattern-item n="vbser"/>
       </pattern>
       <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="out_verb1">
          <with-param pos="1"/>
        </call-macro>
       </action>
    </rule>

    <rule comment="REGLA: VBNOSER: elles mangèrent > els ant megiê, elles arrivèrent > els sont arrevâyes, ils convergent > ils sè rencontront ">
       <pattern>
         <pattern-item n="vbnoser"/>
       </pattern>
       <action>
        <call-macro n="f_set_pron">
          <with-param pos="1"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <var n="pronom"/>
        </out>
        <call-macro n="out_verb1">
          <with-param pos="1"/>
        </call-macro>
       </action>
    </rule>

    <!-- FIN REGLES CAPÇALERA CHUNK + LEMH/LEMQ -->

    <!-- REGLES DATES -->

   <rule comment="REGLA: NUMERAL MOIS (20 janvier > 20 de janviér)">
      <pattern>
        <pattern-item n="num_premier"/>
        <pattern-item n="nom_mois"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="data">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><lit-tag v="m"/></tag>
              <tag><lit-tag v="sg"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

   <rule comment="REGLA: DET NUMERAL MOIS (lo 20 janvier > le 20 de janviér)">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num_premier"/>
        <pattern-item n="nom_mois"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="data">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/>
            </lu>
            <b pos="2"/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <!-- FIN REGLES DATES -->

    <!-- REGLES APPARTENIR -->

    <rule comment="REGLA: PRNDAT APPARTENIR: lui appartient > est a lui">
       <pattern>
         <pattern-item n="prndat"/>
         <pattern-item n="appartenir"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="tipus_prn">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal>
                 <case-of pos="1" side="sl" part="lemh" />
                 <lit v="Aa" />
               </equal>
             </test>
             <modify-case>
               <clip pos="2" side="sl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
             <modify-case>
               <clip pos="2" side="tl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
             <modify-case>
               <clip pos="1" side="sl" part="lemh" />
               <lit v="aa" />
             </modify-case>
             <modify-case>
               <clip pos="1" side="tl" part="lemh" />
               <lit v="aa" />
             </modify-case>
           </when>
         </choose>
         <call-macro n="out_verb1">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <b pos="1"/>
           <chunk name="a">
             <tags>
               <tag><lit-tag v="PREP"/></tag>
             </tags>
             <lu>
               <lit v="a"/>
               <lit-tag v="pr"/>
            </lu>
           </chunk>
           <b/>
           <chunk name="prn">
             <tags>
               <tag><lit-tag v="SPron"/></tag>
               <tag><var n="tipusprn"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE PRNDAT APPARTENIR: ne lui appartient que > est a lui que">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="prndat"/>
         <pattern-item n="appartenir"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="tipus_prn">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
         <choose>
           <when>
             <test>
               <equal>
                 <case-of pos="1" side="sl" part="lemh" />
                 <lit v="Aa" />
               </equal>
             </test>
             <modify-case>
               <clip pos="3" side="sl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
             <modify-case>
               <clip pos="3" side="tl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
           </when>
         </choose>
         <call-macro n="out_verb1">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <b pos="2"/>
           <chunk name="a">
             <tags>
               <tag><lit-tag v="PREP"/></tag>
             </tags>
             <lu>
               <lit v="a"/>
               <lit-tag v="pr"/>
            </lu>
           </chunk>
           <b/>
           <chunk name="prn">
             <tags>
               <tag><lit-tag v="SPron"/></tag>
               <tag><var n="tipusprn"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE PRNDAT APPARTENIR PAS: ne lui appartient pas > est pas més a lui">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="prndat"/>
         <pattern-item n="appartenir"/>
         <pattern-item n="pas"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="tipus_prn">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
         <choose>
           <when>
             <test>
               <equal>
                 <case-of pos="1" side="sl" part="lemh" />
                 <lit v="Aa" />
               </equal>
             </test>
             <modify-case>
               <clip pos="3" side="sl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
             <modify-case>
               <clip pos="3" side="tl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
           </when>
         </choose>
         <call-macro n="out_verb1">
           <with-param pos="3"/>
         </call-macro>
         <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
         <out>
           <b pos="2"/>
           <chunk namefrom="lemma">
            <tags>
              <tag><lit-tag v="SAdv"/></tag>
            </tags>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="3"/>
           <chunk name="a">
             <tags>
               <tag><lit-tag v="PREP"/></tag>
             </tags>
             <lu>
               <lit v="a"/>
               <lit-tag v="pr"/>
            </lu>
           </chunk>
           <b/>
           <chunk name="prn">
             <tags>
               <tag><lit-tag v="SPron"/></tag>
               <tag><var n="tipusprn"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE PRNDAT APPARTENIR PLUS: ne lui appartient plus > est pas més a lui">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="prndat"/>
         <pattern-item n="appartenir"/>
         <pattern-item n="plus_guere"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="tipus_prn">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
         <choose>
           <when>
             <test>
               <equal>
                 <case-of pos="1" side="sl" part="lemh" />
                 <lit v="Aa" />
               </equal>
             </test>
             <modify-case>
               <clip pos="3" side="sl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
             <modify-case>
               <clip pos="3" side="tl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
           </when>
         </choose>
         <call-macro n="out_verb1">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <b pos="2"/>
           <chunk name="pas">
            <tags>
              <tag><lit-tag v="SAdv"/></tag>
            </tags>
             <lu>
               <lit v="pas"/>
               <lit-tag v="adv"/>
             </lu>
             <b/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="3"/>
           <chunk name="a">
             <tags>
               <tag><lit-tag v="PREP"/></tag>
             </tags>
             <lu>
               <lit v="a"/>
               <lit-tag v="pr"/>
            </lu>
           </chunk>
           <b/>
           <chunk name="prn">
             <tags>
               <tag><lit-tag v="SPron"/></tag>
               <tag><var n="tipusprn"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: PRNDAT HAVER APPARTENIR_PP : lui a appartenu > a étâ a lui">
       <pattern>
         <pattern-item n="prndat"/>
         <pattern-item n="vbhaver"/>
         <pattern-item n="appartenir_pp"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="tipus_prn">
           <with-param pos="1"/>
         </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
         <choose>
           <when>
             <test>
               <equal>
                 <case-of pos="1" side="sl" part="lemh" />
                 <lit v="Aa" />
               </equal>
             </test>
             <modify-case>
               <clip pos="2" side="sl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
             <modify-case>
               <clip pos="2" side="tl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
           </when>
         </choose>
         <call-macro n="out_verb1">
           <with-param pos="2"/>
         </call-macro>
         <let><var n="lemma"/><clip pos="3" side="tl" part="lem"/></let>
         <out>
          <b pos="1"/>
           <chunk namefrom="lemma">
             <tags>
               <tag><lit-tag v="SA_pp"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="a_verb"/>
               <clip pos="3" side="tl" part="temps"/>
               <lit-tag v="2"/>
               <lit-tag v="3"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="2"/>
           <chunk name="a">
             <tags>
               <tag><lit-tag v="PREP"/></tag>
             </tags>
             <lu>
               <lit v="a"/>
               <lit-tag v="pr"/>
            </lu>
           </chunk>
           <b/>
           <chunk name="prn">
             <tags>
               <tag><lit-tag v="SPron"/></tag>
               <tag><var n="tipusprn"/></tag>
             </tags>
             <lu>
               <get-case-from pos="3">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE PRNDAT HAVER PAS APPARTENIR_PP : ne lui a pas appartenu > a pas étâ a lui">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="prndat"/>
         <pattern-item n="vbhaver"/>
         <pattern-item n="pas"/>
         <pattern-item n="appartenir_pp"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="tipus_prn">
           <with-param pos="2"/>
         </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="5"/>
        </call-macro>
         <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
         <choose>
           <when>
             <test>
               <equal>
                 <case-of pos="1" side="sl" part="lemh" />
                 <lit v="Aa" />
               </equal>
             </test>
             <modify-case>
               <clip pos="3" side="sl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
             <modify-case>
               <clip pos="3" side="tl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
           </when>
         </choose>
         <call-macro n="out_verb1">
           <with-param pos="3"/>
         </call-macro>
         <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
         <out>
           <b pos="2"/>
           <chunk namefrom="lemma">
            <tags>
              <tag><lit-tag v="SAdv"/></tag>
            </tags>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
         <let><var n="lemma"/><clip pos="5" side="tl" part="lem"/></let>
         <out>
          <b pos="3"/>
           <chunk namefrom="lemma">
             <tags>
               <tag><lit-tag v="SA_pp"/></tag>
               <tag><clip pos="5" side="tl" part="gen"/></tag>
               <tag><clip pos="5" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="5" side="tl" part="lemh"/>
               <clip pos="5" side="tl" part="a_verb"/>
               <clip pos="5" side="tl" part="temps"/>
               <lit-tag v="2"/>
               <lit-tag v="3"/>
               <clip pos="5" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="4"/>
           <chunk name="a">
             <tags>
               <tag><lit-tag v="PREP"/></tag>
             </tags>
             <lu>
               <lit v="a"/>
               <lit-tag v="pr"/>
            </lu>
           </chunk>
           <b/>
           <chunk name="prn">
             <tags>
               <tag><lit-tag v="SPron"/></tag>
               <tag><var n="tipusprn"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <!-- FIN REGLES APPARTENIR -->

    <!-- REGLES VERBES PRONOMINAUX -->

    <rule comment="REGLA: SE VBNOSER: elles se remarièrent > els sè sont remariâyes ; il s'ingère > il s'entèrfère">
       <pattern>
         <pattern-item n="prnref"/>
         <pattern-item n="vbnoser"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="tipus_prn">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test> <!-- forme pronominale du verbe ? -->
               <or>
                 <and>
                   <equal><clip pos="1" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="1" side="tl" part="nbr"/><clip pos="2" side="tl" part="nbr"/></equal>
                 </and>
                 <and>
                   <equal><clip pos="1" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="1" side="tl" part="nbr"/><clip pos="2" side="tl" part="nbr"/></equal>
                 </and>
                 <and>
                   <equal><clip pos="1" side="tl" part="pers"/><lit-tag v="p3"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p3"/></equal>
                   <equal><clip pos="1" side="tl" part="pron"/><lit-tag v="prn.pro.ref"/></equal>
                 </and>
               </or>
             </test>
             <choose>
               <when>
                 <test>
                   <equal><clip pos="2" side="tl" part="a_verb_pron"/><lit-tag v="vblex.no_pron"/></equal>
                 </test>
                 <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
                 <choose>
                   <when>
                     <test>
                       <equal>
                         <case-of pos="1" side="sl" part="lemh" />
                         <lit v="Aa" />
                       </equal>
                     </test>
                     <modify-case>
                       <clip pos="2" side="sl" part="lemh" />
                       <lit v="Aa" />
                     </modify-case>
                     <modify-case>
                       <clip pos="2" side="tl" part="lemh" />
                       <lit v="Aa" />
                     </modify-case>
                   </when>
                 </choose>
                 <call-macro n="out_verb1">
                   <with-param pos="2"/>
                 </call-macro>
               </when>
               <otherwise>
                 <out>
                   <chunk name="prn">
                     <tags>
                       <tag><lit-tag v="SPron"/></tag>
                       <tag><var n="tipusprn"/></tag>
                     </tags>
                     <lu>
                       <clip pos="1" side="tl" part="lemh"/>
                       <clip pos="1" side="tl" part="tags"/>
                       <clip pos="1" side="tl" part="lemq"/>
                     </lu>
                   </chunk>
                   <b pos="1"/>
                 </out>
                 <call-macro n="out_verb_ser1">
                   <with-param pos="2"/>
                 </call-macro>
               </otherwise>
             </choose>
           </when>
           <otherwise> <!-- forme non pronominale du verbe -->
             <out>
               <chunk name="prn">
                 <tags>
                   <tag><lit-tag v="SPron"/></tag>
                   <tag><var n="tipusprn"/></tag>
                 </tags>
                 <lu>
                   <clip pos="1" side="tl" part="lemh"/>
                   <clip pos="1" side="tl" part="tags"/>
                   <clip pos="1" side="tl" part="lemq"/>
                 </lu>
               </chunk>
               <b pos="1"/>
             </out>
             <call-macro n="out_verb1">
               <with-param pos="2"/>
             </call-macro>
           </otherwise>
         </choose>
       </action>
    </rule>

    <rule comment="REGLA: HAVER + PP : elles ont mangé > els ant megiê, ils ont convergé > ils sè sont rencontrâs ">
       <pattern>
         <pattern-item n="vbhaver"/>
         <pattern-item n="pp"/>
       </pattern>
       <action>
        <call-macro n="f_set_pron">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <var n="pronom"/>
        </out>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal><var n="pronom"/><lit v=""/></equal>
            </test>
            <call-macro n="out_verb1">
              <with-param pos="1"/>
            </call-macro>
          </when>
          <otherwise>
            <let><clip pos="1" side="tl" part="lem"/><lit v="étre"/></let>
            <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <choose>
              <when>
                <test>
                  <not><equal><clip pos="1" side="tl" part="nbr"/><lit v=""/></equal></not>
                </test>
                <let><clip pos="2" side="tl" part="nbr"/><clip pos="1" side="tl" part="nbr"/></let>
              </when>
            </choose>
            <call-macro n="out_verb1">
              <with-param pos="1"/>
            </call-macro>
          </otherwise>
        </choose>
        <let><var n="lemma"/><clip pos="2" side="tl" part="lem"/></let>
        <out>
          <b pos="1"/>
          <chunk namefrom="lemma">
            <tags>
              <tag><lit-tag v="SA_pp"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="2"/>
              <lit-tag v="3"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
       </action>
    </rule>

    <!-- FIN REGLES VERBES PRONOMINAUX -->

    <!-- REGLES CONCORDANÇA -->

    <rule comment="REGLA: DET NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det">
            <tags>
              <tag><lit-tag v="Det"/></tag>
              <tag><var n="tipusdet"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="n">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
       <choose>
          <when>
            <test>
              <or>
                <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="mf"/></equal>
                <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="mf"/></equal>
                <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
              </or>
            </test>
            <out>
              <chunk name="det">
                <tags>
                  <tag><lit-tag v="Det"/></tag>
                  <tag><var n="tipusdet"/></tag>
                  <tag><clip pos="2" side="tl" part="gen"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="tags"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="det">
                <tags>
                  <tag><lit-tag v="Det"/></tag>
                  <tag><var n="tipusdet"/></tag>
                  <tag><clip pos="2" side="tl" part="gen"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_det"/>
                  <lit-tag v="3"/>
                  <lit-tag v="4"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="1"/>
          <chunk name="a">
            <tags>
              <tag><lit-tag v="SA"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adjec"/>
              <lit-tag v="2"/>
              <lit-tag v="3"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NPAL (les Calandretas > las Calandretas)">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="npal"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det">
            <tags>
              <tag><lit-tag v="Det"/></tag>
              <tag><var n="tipusdet"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="np">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET ADV ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adv_preadv_pref"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
       <choose>
          <when>
            <test>
              <or>
                <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="mf"/></equal>
                <equal><clip pos="3" side="tl" part="gen"/><lit-tag v="mf"/></equal>
                <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
              </or>
            </test>
            <out>
              <chunk name="det">
                <tags>
                  <tag><lit-tag v="Det"/></tag>
                  <tag><var n="tipusdet"/></tag>
                  <tag><clip pos="3" side="tl" part="gen"/></tag>
                  <tag><clip pos="3" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="tags"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="det">
                <tags>
                  <tag><lit-tag v="Det"/></tag>
                  <tag><var n="tipusdet"/></tag>
                  <tag><clip pos="3" side="tl" part="gen"/></tag>
                  <tag><clip pos="3" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_det"/>
                  <lit-tag v="3"/>
                  <lit-tag v="4"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="plus"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="moins"/></equal>
              </or>
            </test>
            <let><var n="temp"/><lit-tag v="SAcomp"/></let>
          </when>
          <otherwise>
            <let><var n="temp"/><lit-tag v="SA"/></let>
          </otherwise>
        </choose>
        <out>
          <b pos="1"/>
          <chunk name="adv_a">
            <tags>
              <tag><var n="temp"/></tag>
              <tag><clip pos="3" side="tl" part="gen"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adjec"/>
              <lit-tag v="2"/>
              <lit-tag v="3"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det">
            <tags>
              <tag><lit-tag v="Det"/></tag>
              <tag><var n="tipusdet"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="n_a">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: DET ADJ NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec_pref"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="tl" part="lemh"/>
                <list n="adj_frp_post"/>
              </in>
            </test>
            <out>
              <chunk name="det">
                <tags>
                  <tag><lit-tag v="Det"/></tag>
                  <tag><var n="tipusdet"/></tag>
                  <tag><clip pos="2" side="tl" part="gen"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="tags"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
              <b pos="1"/>
              <chunk name="n_a">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><clip pos="3" side="tl" part="gen"/></tag>
                  <tag><clip pos="3" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="tags"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="tags"/>
                  <clip pos="2" side="tl" part="lemg"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="det">
                <tags>
                  <tag><lit-tag v="Det"/></tag>
                  <tag><var n="tipusdet"/></tag>
                  <tag><clip pos="2" side="tl" part="gen"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="tags"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
              <b pos="1"/>
              <chunk name="a_n">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><clip pos="3" side="tl" part="gen"/></tag>
                  <tag><clip pos="3" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="tags"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="tags"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det">
            <tags>
              <tag><lit-tag v="Det"/></tag>
              <tag><var n="tipusdet"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="num_n">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="tl" part="gen"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM ADJ ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec_pref"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det">
            <tags>
              <tag><lit-tag v="Det"/></tag>
              <tag><var n="tipusdet"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="n_a_a">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: DET ADJ NOM ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec_pref"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det">
            <tags>
              <tag><lit-tag v="Det"/></tag>
              <tag><var n="tipusdet"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="a_n_a">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="tl" part="gen"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM NOM ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det">
            <tags>
              <tag><lit-tag v="Det"/></tag>
              <tag><var n="tipusdet"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="num_n_a">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="tl" part="gen"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM ADV ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adv_preadv_pref"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det">
            <tags>
              <tag><lit-tag v="Det"/></tag>
              <tag><var n="tipusdet"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="n_adv_a">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: DET ADV ADJ NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adv_preadv_pref"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="4"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det">
            <tags>
              <tag><lit-tag v="Det"/></tag>
              <tag><var n="tipusdet"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="adv_a_n">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="4" side="tl" part="gen"/></tag>
              <tag><clip pos="4" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: PREDET DET NOM">
      <pattern>
        <pattern-item n="predet"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <chunk name="d_n">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="tl" part="gen"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: ADJ NOM">
      <pattern>
        <pattern-item n="adjec_pref"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="tl" part="lemh"/>
                <list n="adj_frp_post"/>
              </in>
            </test>
            <out>
              <chunk name="n_num">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><clip pos="2" side="tl" part="gen"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="tags"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="tags"/>
                  <clip pos="1" side="tl" part="lemg"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="a_n">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><clip pos="2" side="tl" part="gen"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                  <lu>
                    <clip pos="1" side="tl" part="lemh"/>
                    <clip pos="1" side="tl" part="tags"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lemh"/>
                    <clip pos="2" side="tl" part="tags"/>
                    <clip pos="2" side="tl" part="lemq"/>
                  </lu>
                </chunk>
             </out>
           </otherwise>
         </choose>
      </action>
    </rule>

    <rule comment="REGLA: NOM ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="n_a">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_adjec"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: NUM NOM">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="num_n">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: NUM CNJCOO NUM NOM (deux ou trois années > doves ou três anâs)">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="4"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <chunk name="num_n">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="4" side="tl" part="gen"/></tag>
              <tag><clip pos="4" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: NOM ADJ ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec_pref"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="n_a_a">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: ADJ NOM ADJ">
      <pattern>
        <pattern-item n="adjec_pref"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="a_n_a">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: NUM NOM ADJ">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="num_n_a">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: NUM CNJCOO NUM NOM ADJ (deux ou trois années consécutives > doves ou três anâs siuvues)">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="4"/>
          <with-param pos="5"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <chunk name="num_n_a">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="4" side="tl" part="gen"/></tag>
              <tag><clip pos="4" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="lemh"/>
                <clip pos="5" side="tl" part="tags"/>
                <clip pos="5" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: NUM ADJ NOM">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="adjec_pref"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <chunk name="num_a_n">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="tl" part="gen"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: NOM ADV ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adv_preadv_pref"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="n_adv_a">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: ADV ADJ NOM">
      <pattern>
        <pattern-item n="adv_preadv_pref"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <chunk name="adv_a_n">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="tl" part="gen"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
      </action>
    </rule>

    <rule comment="REGLA: EN NOM (en français: en francés - perquè no faci ´en francesa')">
      <pattern>
        <pattern-item n="enprep"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="GD"/></equal>
            </test>
            <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </test>
            <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <out>
          <chunk name="en_n">
            <tags>
              <tag><lit-tag v="SAdv"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: EN NOM ADJ">
      <pattern>
        <pattern-item n="enprep"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="GD"/></equal>
            </test>
            <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </test>
            <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <chunk name="en_n_adj">
            <tags>
              <tag><lit-tag v="SAdv"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <!-- FIN REGLES CONCORDANÇA -->

    <!-- REGLES CET NOM-CI/LÀ -->

    <rule comment="REGLA: CE_DET NOM-CI > CETI NOM">
      <pattern>
        <pattern-item n="ce_det"/>
        <pattern-item n="nom"/>
        <pattern-item n="ci_postadv"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det">
            <tags>
              <tag><lit-tag v="Det"/></tag>
              <tag><var n="tipusdet"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <lit v="ceti"/>
              </get-case-from>
              <clip pos="1" side="tl" part="tags"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="n">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: CE_DET NOM-LÀ > CÉL NOM">
      <pattern>
        <pattern-item n="ce_det"/>
        <pattern-item n="nom"/>
        <pattern-item n="la_postadv"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="tipus_det">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det">
            <tags>
              <tag><lit-tag v="Det"/></tag>
              <tag><var n="tipusdet"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <lit v="cél"/>
              </get-case-from>
              <clip pos="1" side="tl" part="tags"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="n">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <!-- FIN REGLES CET NOM-CI/LÀ -->

    <!-- REGLES TOP -->

    <rule comment="REGLA: DETDEF NPTOP (la Grèce > la Grècia)">
      <pattern>
        <pattern-item n="detdef"/>
        <pattern-item n="nptop"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="det-nptop">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DETDEF NPTOP ADJ (la Grèce ancienne > la Grècia antica)">
      <pattern>
        <pattern-item n="detdef"/>
        <pattern-item n="nptop"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="det-nptop-adj">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DETDEF ADJ NPTOP (l'ancienne Grèce > l'antica Grècia)">
      <pattern>
        <pattern-item n="detdef"/>
        <pattern-item n="adj"/>
        <pattern-item n="nptop"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <chunk name="det-nptop-adj">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="tl" part="gen"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <!-- FIN REGLES TOP -->

    <!-- REGLES ELISION NE -->

    <rule comment="REGLA: NE PAS INF > PAS INF: ne pas manger > pas megiér">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="pas"/>
         <pattern-item n="inf"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="v">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="3" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="2" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE PAS PRNPRO INF > PAS PRNPRO INF: ne pas lui dire > pas lui dére">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="pas"/>
         <pattern-item n="prnpro"/>
         <pattern-item n="inf"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="v">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="3" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="2" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE PAS PRNPRO PRNPRO INF > PAS PRNPRO PRNPRO INF: ne pas le lui dire > pas lo lui dére">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="pas"/>
         <pattern-item n="prnpro"/>
         <pattern-item n="prnpro"/>
         <pattern-item n="inf"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="v">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="3" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="2" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b pos="4"/>
             <lu>
               <clip pos="5" side="tl" part="lemh"/>
               <clip pos="5" side="tl" part="tags"/>
               <clip pos="5" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE PLUS INF > INF PAS MÉS: ne plus manger > manjar pas més">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="plus_guere"/>
         <pattern-item n="inf"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="v">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="3" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="3" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="pas"/>
               <lit-tag v="adv"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE VBSER > VBSER: Jean n'est pas > Jean est pas">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="vbser"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal>
                 <case-of pos="1" side="sl" part="lemh" />
                 <lit v="Aa" />
               </equal>
             </test>
             <modify-case>
               <clip pos="2" side="sl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
             <modify-case>
               <clip pos="2" side="tl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
           </when>
         </choose>
         <call-macro n="out_verb1">
           <with-param pos="2"/>
         </call-macro>
       </action>
    </rule>

    <rule comment="REGLA: NE VBNOSER > VBNOSER: Jean ne dit pas > Jean dit pas, ils ne convergent pas > ils sè rencontront pas">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="vbnoser"/>
       </pattern>
       <action>
         <call-macro n="f_set_pron">
           <with-param pos="2"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
         <out>
           <var n="pronom"/>
         </out>
         <choose>
           <when>
             <test>
               <and>
                 <equal><var n="pronom"/><lit v="" /></equal>
                 <equal><case-of pos="1" side="sl" part="lemh" /><lit v="Aa" /></equal>
               </and>
             </test>
             <modify-case>
               <clip pos="2" side="sl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
             <modify-case>
               <clip pos="2" side="tl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
           </when>
         </choose>
         <call-macro n="out_verb1">
           <with-param pos="2"/>
         </call-macro>
       </action>
    </rule>

    <rule comment="REGLA: NE VBSER PLUS > VBSER PAS MÉS: Jean n'est plus > Jean est pas més">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="vbser"/>
         <pattern-item n="plus_guere"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="vbser">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="2" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="2" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="pas"/>
               <lit-tag v="adv"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE VBNOSER JAMAIS > VBNOSER PAS JAMAI: ne dure guère > ne dura gouéro">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="vbnoser"/>
         <pattern-item n="plus_guere"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal>
                 <case-of pos="1" side="sl" part="lemh" />
                 <lit v="Aa" />
               </equal>
             </test>
             <modify-case>
               <clip pos="2" side="sl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
             <modify-case>
               <clip pos="2" side="tl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
           </when>
         </choose>
         <call-macro n="out_verb1">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <b/>
           <chunk name="pas">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
             <lu>
               <lit v="pas"/>
               <lit-tag v="adv"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE PRNPRO VERB > PRNPRO VERB: ne lui donne pas > lui balye pas ; ne lui donna pas > lui at balyê pas ; ne se donna pas > s'est balyê pas">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="prnpro"/>
         <pattern-item n="verb"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="tipus_prn">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
         <choose>
           <when>
             <test> <!-- forme pronominale du verbe ? -->
               <or>
                 <and>
                   <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="me"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                 </and>
                 <and>
                   <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="te"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                 </and>
                 <and>
                   <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="nous"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                 </and>
                 <and>
                   <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="vous"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                 </and>
                 <and>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p3"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p3"/></equal>
                   <equal><clip pos="2" side="tl" part="pron"/><lit-tag v="prn.pro.ref"/></equal>
                 </and>
               </or>
             </test>
             <choose>
               <when>
                 <test>
                   <equal><clip pos="3" side="tl" part="a_verb_pron"/><lit-tag v="vblex.no_pron"/></equal>
                 </test>
                 <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
                 <choose>
                   <when>
                     <test>
                       <equal>
                         <case-of pos="1" side="sl" part="lemh" />
                         <lit v="Aa" />
                       </equal>
                     </test>
                     <modify-case>
                       <clip pos="3" side="sl" part="lemh" />
                       <lit v="Aa" />
                     </modify-case>
                     <modify-case>
                       <clip pos="3" side="tl" part="lemh" />
                       <lit v="Aa" />
                     </modify-case>
                   </when>
                 </choose>
                 <call-macro n="out_verb1">
                   <with-param pos="3"/>
                 </call-macro>
               </when>
               <otherwise>
                 <out>
                   <chunk name="prn">
                     <tags>
                       <tag><lit-tag v="SPron"/></tag>
                       <tag><var n="tipusprn"/></tag>
                     </tags>
                     <lu>
                       <get-case-from pos="1">
                         <clip pos="2" side="tl" part="lemh"/>
                       </get-case-from>
                       <clip pos="2" side="tl" part="tags"/>
                       <clip pos="2" side="tl" part="lemq"/>
                     </lu>
                   </chunk>
                   <b pos="2"/>
                 </out>
                 <call-macro n="out_verb_ser1">
                   <with-param pos="3"/>
                 </call-macro>
               </otherwise>
             </choose>
           </when>
           <otherwise> <!-- forme non pronominale du verbe -->
             <out>
               <chunk name="prn">
                 <tags>
                   <tag><lit-tag v="SPron"/></tag>
                   <tag><var n="tipusprn"/></tag>
                 </tags>
                 <lu>
                   <get-case-from pos="1">
                     <clip pos="2" side="tl" part="lemh"/>
                   </get-case-from>
                   <clip pos="2" side="tl" part="tags"/>
                   <clip pos="2" side="tl" part="lemq"/>
                 </lu>
               </chunk>
               <b pos="2"/>
             </out>
             <call-macro n="out_verb1">
               <with-param pos="3"/>
             </call-macro>
           </otherwise>
         </choose>
       </action>
    </rule>

    <rule comment="REGLA: NE PRNPRO VERB PLUS > PRNPRO VERB: ne lui donne plus > lui balye pas més ; ne lui donna plus > lui at balyê pas més ; ne se donna plus > s'est balyê pas més">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="prnpro"/>
         <pattern-item n="verb"/>
         <pattern-item n="plus_guere"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="tipus_prn">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
         <choose>
           <when>
             <test> <!-- forme pronominale du verbe ? -->
               <or>
                 <and>
                   <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="me"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                 </and>
                 <and>
                   <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="te"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                 </and>
                 <and>
                   <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="nous"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                 </and>
                 <and>
                   <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="vous"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                 </and>
                 <and>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p3"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p3"/></equal>
                   <equal><clip pos="2" side="tl" part="pron"/><lit-tag v="prn.pro.ref"/></equal>
                 </and>
               </or>
             </test>
             <choose>
               <when>
                 <test>
                   <equal><clip pos="3" side="tl" part="a_verb_pron"/><lit-tag v="vblex.no_pron"/></equal>
                 </test>
                 <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
                 <choose>
                   <when>
                     <test>
                       <equal>
                         <case-of pos="1" side="sl" part="lemh" />
                         <lit v="Aa" />
                       </equal>
                     </test>
                     <modify-case>
                       <clip pos="3" side="sl" part="lemh" />
                       <lit v="Aa" />
                     </modify-case>
                     <modify-case>
                       <clip pos="3" side="tl" part="lemh" />
                       <lit v="Aa" />
                     </modify-case>
                   </when>
                 </choose>
                 <call-macro n="out_verb1">
                   <with-param pos="3"/>
                 </call-macro>
               </when>
               <otherwise>
                 <out>
                   <chunk name="prn">
                     <tags>
                       <tag><lit-tag v="SPron"/></tag>
                       <tag><var n="tipusprn"/></tag>
                     </tags>
                     <lu>
                       <get-case-from pos="1">
                         <clip pos="2" side="tl" part="lemh"/>
                       </get-case-from>
                       <clip pos="2" side="tl" part="tags"/>
                       <clip pos="2" side="tl" part="lemq"/>
                     </lu>
                   </chunk>
                   <b pos="2"/>
                 </out>
                 <call-macro n="out_verb_ser1">
                   <with-param pos="3"/>
                 </call-macro>
               </otherwise>
             </choose>
           </when>
           <otherwise> <!-- forme non pronominale du verbe -->
             <out>
               <chunk name="prn">
                 <tags>
                   <tag><lit-tag v="SPron"/></tag>
                   <tag><var n="tipusprn"/></tag>
                 </tags>
                 <lu>
                   <get-case-from pos="1">
                     <clip pos="2" side="tl" part="lemh"/>
                   </get-case-from>
                   <clip pos="2" side="tl" part="tags"/>
                   <clip pos="2" side="tl" part="lemq"/>
                 </lu>
               </chunk>
               <b pos="2"/>
             </out>
             <call-macro n="out_verb1">
               <with-param pos="3"/>
             </call-macro>
           </otherwise>
         </choose>
         <out>
           <b/>
           <chunk name="pas">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
             <lu>
               <lit v="pas"/>
               <lit-tag v="adv"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE PRNPRO VERB QUE > PRNPRO VERB: ne lui donne que > ne lui balye que ; ne lui donna que > ne lui at balyê que ; ne se donna que > ne s'est balyê que">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="prnpro"/>
         <pattern-item n="verb"/>
         <pattern-item n="que_cnjsub"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="tipus_prn">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="ne">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
           </chunk>
           <b pos="1"/>
         </out>
         <choose>
           <when>
             <test> <!-- forme pronominale du verbe ? -->
               <or>
                 <and>
                   <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="me"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                 </and>
                 <and>
                   <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="te"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                 </and>
                 <and>
                   <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="nous"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p1"/></equal>
                   <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                 </and>
                 <and>
                   <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="vous"/></equal>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p2"/></equal>
                   <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                 </and>
                 <and>
                   <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p3"/></equal>
                   <equal><clip pos="3" side="tl" part="pers"/><lit-tag v="p3"/></equal>
                   <equal><clip pos="2" side="tl" part="pron"/><lit-tag v="prn.pro.ref"/></equal>
                 </and>
               </or>
             </test>
             <choose>
               <when>
                 <test>
                   <equal><clip pos="3" side="tl" part="a_verb_pron"/><lit-tag v="vblex.no_pron"/></equal>
                 </test>
                 <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
                 <call-macro n="out_verb1">
                   <with-param pos="3"/>
                 </call-macro>
               </when>
               <otherwise>
                 <out>
                   <chunk name="prn">
                     <tags>
                       <tag><lit-tag v="SPron"/></tag>
                       <tag><var n="tipusprn"/></tag>
                     </tags>
                     <lu>
                       <clip pos="2" side="tl" part="lemh"/>
                       <clip pos="2" side="tl" part="tags"/>
                       <clip pos="2" side="tl" part="lemq"/>
                     </lu>
                   </chunk>
                   <b pos="2"/>
                 </out>
                 <call-macro n="out_verb_ser1">
                   <with-param pos="3"/>
                 </call-macro>
               </otherwise>
             </choose>
           </when>
           <otherwise> <!-- forme non pronominale du verbe -->
             <out>
               <chunk name="prn">
                 <tags>
                   <tag><lit-tag v="SPron"/></tag>
                   <tag><var n="tipusprn"/></tag>
                 </tags>
                 <lu>
                   <clip pos="2" side="tl" part="lemh"/>
                   <clip pos="2" side="tl" part="tags"/>
                   <clip pos="2" side="tl" part="lemq"/>
                 </lu>
               </chunk>
               <b pos="2"/>
             </out>
             <call-macro n="out_verb1">
               <with-param pos="3"/>
             </call-macro>
           </otherwise>
         </choose>
         <out>
           <b pos="3"/>
           <chunk name="cnjsub">
             <tags>
               <tag><lit-tag v="cnjsub"/></tag>
             </tags>
             <lu>
               <clip pos="4" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: PERSONNE NE VERB (personne ne dit: degun ditz pas)">
      <pattern>
        <pattern-item n="personne"/>
        <pattern-item n="ne"/>
        <pattern-item n="verbconj"/>
      </pattern>
      <action>
         <out>
           <chunk name="prn">
             <tags>
               <tag><lit-tag v="SPron"/></tag>
               <tag><lit-tag v="normal"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="1"/>
         </out>
         <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
         <out>
           <chunk name="verb">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="3" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="3" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="pas"/>
               <lit-tag v="adv"/>
             </lu>
           </chunk>
         </out>
      </action>
    </rule>

<!--
    <rule comment="REGLA: NE VBNOSER PREP PERSONNE/RIEN > VBNOSER PAS PREP DEGUN/RES: Jean ne dit à personne > Jean ditz pas a degun">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="vbnoser"/>
         <pattern-item n="pr"/>
         <pattern-item n="rien_personne"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="verb">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="2" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="2" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
              </lu>
             <b/>
             <lu>
               <lit v="pas"/>
               <lit-tag v="adv"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="whole"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: PRNSUBJ NE VERB PREP PERSONNE/RIEN > VERB PAS PREP DEGUN/RES: il ne dit à personne > il ditz pas a degun">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="ne"/>
        <pattern-item n="verbconj"/>
        <pattern-item n="pr"/>
        <pattern-item n="rien_personne"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_bcond">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="verb">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="3" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="3" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="pas"/>
               <lit-tag v="adv"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="whole"/>
             </lu>
             <b pos="4"/>
             <lu>
               <clip pos="5" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
      </action>
    </rule>
-->

    <rule comment="REGLA: NE AVOIR RIEN PP > AVER PAS PP RES: Jean n'a rien dit > Jean a diz pas res">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="vbhaver"/>
         <pattern-item n="rien"/>
         <pattern-item n="pp_no_ser"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="verb">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="4" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="2" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
              </lu>
             <b/>
             <lu>
               <lit v="pas"/>
               <lit-tag v="adv"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="4" side="tl" part="whole"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="3" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

<!--
    <rule comment="REGLA: PRNSUBJ NE AVOIR RIEN PP > AVER PAS PP RES: il n'a rien dit > a diz pas res">
       <pattern>
         <pattern-item n="prnsubj"/>
         <pattern-item n="ne"/>
         <pattern-item n="vbhaver"/>
         <pattern-item n="rien"/>
         <pattern-item n="pp_no_ser"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_bcond">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="verb">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="5" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="3" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
              </lu>
             <b/>
             <lu>
               <lit v="pas"/>
               <lit-tag v="adv"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="5" side="tl" part="whole"/>
             </lu>
             <b pos="4"/>
             <lu>
               <clip pos="4" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>
-->

    <rule comment="REGLA: NE PRNPRO AVOIR RIEN PP > PRNPRO AVER PAS PP RES: Jean ne lui a rien dit > Jean li a diz pas res">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="prnpro"/>
         <pattern-item n="vbhaver"/>
         <pattern-item n="rien"/>
         <pattern-item n="pp_no_ser"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="verb">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="5" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="2" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
              </lu>
             <b/>
             <lu>
               <lit v="pas"/>
               <lit-tag v="adv"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="5" side="tl" part="whole"/>
             </lu>
             <b pos="4"/>
             <lu>
               <clip pos="4" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

<!--
    <rule comment="REGLA: PRNSUBJ NE PRNPRO AVOIR RIEN PP > PRNPRO AVER PAS PP RES: il ne lui a rien dit > li a diz pas res">
       <pattern>
         <pattern-item n="prnsubj"/>
         <pattern-item n="ne"/>
         <pattern-item n="prnpro"/>
         <pattern-item n="vbhaver"/>
         <pattern-item n="rien"/>
         <pattern-item n="pp_no_ser"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_bcond">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="verb">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="6" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="3" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
              </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
              </lu>
             <b/>
             <lu>
               <lit v="pas"/>
               <lit-tag v="adv"/>
             </lu>
             <b pos="4"/>
             <lu>
               <clip pos="6" side="tl" part="whole"/>
             </lu>
             <b pos="5"/>
             <lu>
               <clip pos="5" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>
-->

    <rule comment="REGLA: NE VAUX PP PERSONNE/RIEN > NE VAUX PERSONNE/RIEN PP: je n'ai mangé personne > j'é nion megiê">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="vaux"/>
         <pattern-item n="pp"/>
         <pattern-item n="rien_personne"/>
       </pattern>
       <action>
         <call-macro n="f_chunk_tags">
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal>
                 <case-of pos="1" side="sl" part="lemh" />
                 <lit v="Aa" />
               </equal>
             </test>
             <modify-case>
               <clip pos="2" side="sl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
             <modify-case>
               <clip pos="2" side="tl" part="lemh" />
               <lit v="Aa" />
             </modify-case>
           </when>
         </choose>
         <call-macro n="out_verb1">
           <with-param pos="2"/>
         </call-macro>
          <out>
            <b pos="2"/>
            <chunk name="pp">
              <tags>
                <tag><lit-tag v="SA"/></tag>
                <tag><clip pos="3" side="tl" part="gen"/></tag>
                <tag><clip pos="3" side="tl" part="nbr"/></tag>
                <tag><var n="genero_sl"/></tag>
                <tag><var n="numero_sl"/></tag>
              </tags>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_adjec"/>
                <lit-tag v="2"/>
                <lit-tag v="3"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
       </action>
    </rule>

  <!-- FIN REGLES ELISION NE -->

  <!-- REGLES NE... QUE -->

    <rule comment="REGLA: NE VERB QUE > NE VERB QUE: Jean n'est que > Jean n'est que, je ne mange que > je ne mejo que">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="verb"/>
         <pattern-item n="que_cnjsub"/>
       </pattern>
       <action>
         <out>
           <chunk name="ne">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="1"/>
          </out>
          <call-macro n="out_verb1">
            <with-param pos="2"/>
          </call-macro>
          <out>
            <b pos="2"/>
            <chunk name="cnjsub">
              <tags>
                <tag><lit-tag v="cnjsub"/></tag>
              </tags>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE VAUX pp QUE > NE VAUX pp QUE: Jean n'est arrivé que > Jean n'est arrevâ que, je n'ai mangé que > je n'é megiê que">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="vaux"/>
         <pattern-item n="pp"/>
         <pattern-item n="que_cnjsub"/>
       </pattern>
       <action>
         <call-macro n="f_chunk_tags">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="ne">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="1"/>
          </out>
          <call-macro n="out_verb1">
            <with-param pos="2"/>
          </call-macro>
          <out>
            <b pos="2"/>
              <chunk name="pp">
                <tags>
                  <tag><lit-tag v="SA"/></tag>
                  <tag><clip pos="3" side="tl" part="gen"/></tag>
                  <tag><clip pos="3" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_adjec"/>
                  <lit-tag v="2"/>
                  <lit-tag v="3"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            <b pos="3"/>
            <chunk name="cnjsub">
              <tags>
                <tag><lit-tag v="cnjsub"/></tag>
              </tags>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE VERB adjec QUE > NE VBSER QUE: il ne semble bon que > il ne semble bon que">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="verb"/>
         <pattern-item n="adjec"/>
         <pattern-item n="que_cnjsub"/>
       </pattern>
       <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="ne">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="1"/>
          </out>
          <call-macro n="out_verb1">
            <with-param pos="2"/>
          </call-macro>
          <out>
            <b pos="2"/>
              <chunk name="a">
                <tags>
                  <tag><lit-tag v="SA"/></tag>
                  <tag><clip pos="3" side="tl" part="gen"/></tag>
                  <tag><clip pos="3" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_adjec"/>
                  <lit-tag v="2"/>
                  <lit-tag v="3"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            <b pos="3"/>
            <chunk name="cnjsub">
              <tags>
                <tag><lit-tag v="cnjsub"/></tag>
              </tags>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: NE VERB INF QUE > NE VERB INF QUE: Jean ne peut arriver que > Jean ne pôt arrevar que">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="verb"/>
         <pattern-item n="inf"/>
         <pattern-item n="que_cnjsub"/>
       </pattern>
       <action>
         <out>
           <chunk name="ne">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="1"/>
          </out>
          <call-macro n="out_verb1">
            <with-param pos="2"/>
          </call-macro>
          <out>
            <b pos="2"/>
            <chunk name="v">
              <tags>
                <tag><lit-tag v="SV"/></tag>
                <tag><clip pos="3" side="tl" part="a_verb"/></tag>
              </tags>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
            <b pos="3"/>
            <chunk name="cnjsub">
              <tags>
                <tag><lit-tag v="cnjsub"/></tag>
              </tags>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
       </action>
    </rule>


    <rule comment="REGLA: NE VAUX pp INF QUE > NE VAUX pp INF QUE: Jean n'a pu arriver que > Jean n'at pu arrevar que">
       <pattern>
         <pattern-item n="ne"/>
         <pattern-item n="vaux"/>
         <pattern-item n="pp"/>
         <pattern-item n="inf"/>
         <pattern-item n="que_cnjsub"/>
       </pattern>
       <action>
         <call-macro n="f_chunk_tags">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="ne">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="1"/>
          </out>
          <call-macro n="out_verb1">
            <with-param pos="2"/>
          </call-macro>
          <out>
            <b pos="2"/>
              <chunk name="pp">
                <tags>
                  <tag><lit-tag v="SA"/></tag>
                  <tag><clip pos="3" side="tl" part="gen"/></tag>
                  <tag><clip pos="3" side="tl" part="nbr"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_adjec"/>
                  <lit-tag v="2"/>
                  <lit-tag v="3"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            <b pos="3"/>
            <chunk name="v">
              <tags>
                <tag><lit-tag v="SV"/></tag>
                <tag><clip pos="4" side="tl" part="a_verb"/></tag>
              </tags>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </chunk>
            <b pos="4"/>
            <chunk name="cnjsub">
              <tags>
                <tag><lit-tag v="cnjsub"/></tag>
              </tags>
              <lu>
                <clip pos="5" side="tl" part="lemh"/>
                <clip pos="5" side="tl" part="tags"/>
                <clip pos="5" side="tl" part="lemq"/>
              </lu>
            </chunk>
         </out>
       </action>
    </rule>

  <!-- FIN REGLES NE... QUE -->

  <!-- ÔTRES REGLES VERBALES -->

    <rule comment="REGLA: IMP PRNENC">
       <pattern>
         <pattern-item n="verb"/>
         <pattern-item n="prnenc"/>
       </pattern>
       <action>
         <out>
           <chunk name="v_enc">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <mlu>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="a_verb"/>
                 <clip pos="1" side="tl" part="temps"/>
                 <clip pos="1" side="tl" part="pers"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
             </mlu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: IMP PRNENC PRNENC">
       <pattern>
         <pattern-item n="aller"/>
         <pattern-item n="prnenc"/>
         <pattern-item n="prnenc"/>
       </pattern>
       <action>
         <out>
           <chunk name="v_enc">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <mlu>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="a_verb"/>
                 <clip pos="1" side="tl" part="temps"/>
                 <clip pos="1" side="tl" part="pers"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="3" side="tl" part="lemq"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
             </mlu>
           </chunk>
         </out>
       </action>
    </rule>

  <!-- FIN ÔTRES REGLES VERBALES -->

    <rule comment="REGLA: IL EN FAIT > en fa (pedaç per evitar il + 'en fa' (adv) ">
       <pattern>
         <pattern-item n="il_elle"/>
         <pattern-item n="en_fait"/>
       </pattern>
       <action>
         <call-macro n="f_bcond">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="pro-verb">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="3" side="tl" part="a_verb"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <lit v="en"/>
               </get-case-from>
              <lit-tag v="prn.pro.adv"/>
             </lu>
             <b/>
             <lu>
              <lit v="far"/>
              <lit-tag v="vblex.pri.p3.sg"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: IL Y A NUM NOM_TEMPS > NUM NOM_TEMPS EN ARRIÉR">
       <pattern>
         <pattern-item n="il"/>
         <pattern-item n="y"/>
         <pattern-item n="a"/>
         <pattern-item n="det_num"/>
         <pattern-item n="n_temps"/>
       </pattern>
       <action>
         <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
         <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
         <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
         <out>
           <chunk name="en-arriér">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="4" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="4" side="tl" part="tags"/>
             </lu>
             <b pos="4"/>
             <lu>
               <clip pos="5" side="tl" part="lemh"/>
               <clip pos="5" side="tl" part="tags"/>
               <clip pos="5" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="3">
                 <lit v="en arriér"/>
               </get-case-from>
              <lit-tag v="adv"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="REGLA: LPAR">
      <pattern>
        <pattern-item n="lpar"/>
      </pattern>
      <action>
        <out>
          <chunk name="lpar">
            <tags>
              <tag><lit-tag v="LPAR"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: RPAR">
      <pattern>
        <pattern-item n="rpar"/>
      </pattern>
      <action>
        <out>
          <chunk name="rpar">
            <tags>
              <tag><lit-tag v="RPAR"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: CM">
      <pattern>
        <pattern-item n="cm"/>
      </pattern>
      <action>
        <out>
          <chunk name="cm">
            <tags>
              <tag><lit-tag v="CM"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: SENT">
      <pattern>
        <pattern-item n="sent"/>
      </pattern>
      <action>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <out>
          <chunk name="sent" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SENT"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

  </section-rules>


</transfer>

<!--
Resources:
    http://wiki.apertium.org/wiki/Chunking:_A_full_example
    http://wiki.apertium.org/wiki/Chunking
    http://wiki.apertium.org/wiki/Apertium_New_Language_Pair_HOWTO#Transfer_rules
    http://wiki.apertium.org/wiki/A_long_introduction_to_transfer_rules
    http://wiki.apertium.org/wiki/Transfer#Adding_structural_transfer_.28grammar.29_rules
-->

